chapter 4 from second branch

updated